<html>
      <head>
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
        <title>6th</title>
        <link type="text/css" rel="stylesheet" href="assets/css/show.css" />
        <link type="text/css" rel="stylesheet" href="assets/css/prettify.css" />
        <script type="text/javascript" src="assets/js/jquery.min.js"></script>
        <script type="text/javascript" src="assets/js/show.js"></script>
        <script type="text/javascript" src="assets/js/prettify/prettify.js"></script>
        <script type="text/javascript" src="assets/js/prettify/lang-apollo.js"></script><script type="text/javascript" src="assets/js/prettify/lang-css.js"></script><script type="text/javascript" src="assets/js/prettify/lang-hs.js"></script><script type="text/javascript" src="assets/js/prettify/lang-lisp.js"></script><script type="text/javascript" src="assets/js/prettify/lang-lua.js"></script><script type="text/javascript" src="assets/js/prettify/lang-ml.js"></script><script type="text/javascript" src="assets/js/prettify/lang-proto.js"></script><script type="text/javascript" src="assets/js/prettify/lang-scala.js"></script><script type="text/javascript" src="assets/js/prettify/lang-sql.js"></script><script type="text/javascript" src="assets/js/prettify/lang-sql.js"></script><script type="text/javascript" src="assets/js/prettify/lang-vb.js"></script><script type="text/javascript" src="assets/js/prettify/lang-vhdl.js"></script><script type="text/javascript" src="assets/js/prettify/lang-wiki.js"></script><script type="text/javascript" src="assets/js/prettify/lang-yaml.js"></script><link type="text/css" rel="stylesheet" href="css/custom.css?1409842216980" />
      <script type="text/javascript"><!--
        window.onload=function() { prettyPrint(); };
      --></script>
      </head>
      <body>
        <div id="slides">
          <div id="reel">
            <div class="content" id="slide-0"><div class="container">
                  <h1 id="Effective+Java%E3%82%92%E8%AA%AD%E3%82%80%E4%BC%9A">Effective Javaを読む会</h1><h2 id="6%E5%9B%9E%E7%9B%AE">6回目</h2><h2 id=""><a  href="https://twitter.com/numa08">@numa08</a></h2>
                </div>
      </div><div class="content" id="slide-1"><div class="container">
                  <h2 id="%E3%81%8A%E5%93%81%E6%9B%B8%E3%81%8D">お品書き</h2><ul><li>配列よりリストを選ぶ(項目25)
</li><li>ジェネリック型を利用する(項目26)
</li></ul>
                </div>
      </div><div class="content" id="slide-2"><div class="container">
                  <h2 id="%E9%85%8D%E5%88%97%E3%82%88%E3%82%8A%E3%83%AA%E3%82%B9%E3%83%88%E3%82%92%E9%81%B8%E3%81%B6">配列よりリストを選ぶ</h2><h2 id="%E3%81%9F%E3%81%A3%E3%81%9F2%E3%81%A4%E3%81%AE%E9%85%8D%E5%88%97%E3%81%A8%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%83%83%E3%82%AF%E5%9E%8B%E3%81%AE%E9%81%95%E3%81%84">たった2つの配列とジェネリック型の違い</h2><ul><li>共変(convariant)であること
</li><li>具象化(reified)されていること
</li></ul>
                </div>
      </div><div class="content" id="slide-3"><div class="container">
                  <h2 id="%E5%85%B1%E5%A4%89%E3%81%A7%E3%81%82%E3%82%8B%E3%81%93%E3%81%A8">共変であること</h2><ul><li><code>Sub</code>が<code>Super</code>のサブタイプのとき
</li><li><code>Sub[]</code>は<code>Super[]</code>のサブタイプである
</li></ul><h2 id="%E4%B8%8D%E5%A4%89%28invariant%29%E3%81%A7%E3%81%82%E3%82%8B%E3%81%93%E3%81%A8">不変(invariant)であること</h2><ul><li><code>Sub</code>が<code>Super</code>のサブタイプのとき
</li><li><code>List&lt;Sub&gt;</code>は<code>List&lt;Super&gt;</code>のサブタイプではない
</li></ul>
                </div>
      </div><div class="content" id="slide-4"><div class="container">
                  <h2 id="%E5%85%B1%E5%A4%89%E3%81%A8%E4%B8%8D%E5%A4%89">共変と不変</h2><pre><code class="prettyprint lang-java">Object[] array = new Long[1];
array[0] = &quot;I am long&quot;; //ArrayStoreException

List&lt;Object&gt; list = new ArrayList&lt;Object&gt;();
list.add(&quot;I am object&quot;); //コンパイルエラー
</code></pre><p>後者の方が、実行前に分かるので安全と言える。
</p>
                </div>
      </div><div class="content" id="slide-5"><div class="container">
                  <h2 id="%E5%85%B7%E8%B1%A1%E5%8C%96%E3%81%95%E3%82%8C%E3%81%A6%E3%81%84%E3%82%8B%E3%81%93%E3%81%A8">具象化されていること</h2><ul><li>配列は実行時に要素の型を知る
</li><li>型に対する不正な動作は、実行時に分かる
</li></ul><h2 id="%E3%82%A4%E3%83%AC%E3%82%A4%E3%82%B8%E3%83%A3">イレイジャ</h2><ul><li>コンパイル時のみ型制約を強制
</li><li>実行時には型情報は無くなっている
</li><li>ジェネリクス未使用のコードとの互換性！！
</li><li>Java9から無くなるとかなんとか？
</li></ul>
                </div>
      </div><div class="content" id="slide-6"><div class="container">
                  <h2 id="%E3%82%B8%E3%82%A7%E3%83%8D%E3%83%AA%E3%82%AF%E3%82%B9%E3%81%A8%E9%85%8D%E5%88%97">ジェネリクスと配列</h2><pre><code class="prettyprint lang-java">List&lt;String&gt;[] stringLists = new ArrayList&lt;String&gt;[1]; //コンパイルエラー
List&lt;Integer&gt; intList = Arrays.asList(42);
Object[] objects = stringLists;
objects[0] = intList;
String s = stringLists[0].get(0); //ClassCastException!!
</code></pre><p>コンパイル時に未然に型に対する不正な操作を防ぐ
</p>
                </div>
      </div><div class="content" id="slide-7"><div class="container">
                  <h2 id="%E7%A9%8D%E6%A5%B5%E7%9A%84%E3%81%AB%E3%82%B3%E3%83%AC%E3%82%AF%E3%82%B7%E3%83%A7%E3%83%B3%E3%82%92%E4%BD%BF%E3%81%88">積極的にコレクションを使え</h2><ul><li>ジェネリクスの配列は基本的に無理
</li><li>ジェネリクスのコレクションを扱うなら、積極的にCollection APIを使え
</li></ul>
                </div>
      </div><div class="content" id="slide-8"><div class="container">
                  <h2 id="reduce%E3%81%AE%E5%AE%9F%E8%A3%85%E3%82%92%E8%80%83%E3%81%88%E3%82%8B">reduceの実装を考える</h2><ul><li>不定の型のコレクション、適応する関数を受け取って関数を適応して帰す
</li></ul><pre><code class="prettyprint lang-java">reduce(List(1, 2, 3) , (_ + _), 0) // 0 + 1 + 2 + 3 -&gt; 6
reduce(List(4, 5, 6) , (_ * _), 2) // 2 * 4 * 5 * 6 -&gt; 240
</code></pre>
                </div>
      </div><div class="content" id="slide-9"><div class="container">
                  <h2 id="reduce">reduce</h2><pre><code class="prettyprint lang-java">public &lt;E&gt; E reduce(List&lt;E&gt; list, Function&lt;E, E, E&gt; f, E r) {
  List&lt;E&gt; snap;
  synchronized(list) {
    snap = new ArrayList&lt;E&gt;(list);
  }
  E result = r;
  for(E e : list) {
    r = f.apply(result, e);
  }
  return result;
}

interface Function&lt;A, B, C&gt; {
  C apply(A, B);
}

</code></pre>
                </div>
      </div><div class="content" id="slide-10"><div class="container">
                  <pre><code class="prettyprint lang-java">public void reduceTest() {
  final int result = reduce(Arrays.asList(1,2,3),
			     new Function&lt;Int, Int, Int&gt; {
				Int apply(Int a, Int b) { return a + b;}
                             }, 0);
  assertThat(result, is(6));
}
</code></pre>
                </div>
      </div><div class="content" id="slide-11"><div class="container">
                  <h2 id="%E4%BB%8A%E3%80%81%E3%81%93%E3%82%93%E3%81%AA%E3%81%93%E3%81%A8%E3%82%92%E3%82%84%E3%82%89%E3%81%AA%E3%81%84%E3%82%88%E3%81%86%E3%81%AB">今、こんなことをやらないように</h2>
                </div>
      </div><div class="content" id="slide-12"><div class="container">
                  <pre><code class="prettyprint lang-java">final List&lt;Integer&gt; list = Arrays.asList(1,2,3);
list.stream()
    .reduce(0, (a, b) -&gt; a + b));//6
</code></pre>
                </div>
      </div><div class="content" id="slide-13"><div class="container">
                  <h2 id=""><a  href="https://gist.github.com/numa08/a166ad60cf75543044dc">numa08/stack.java</a></h2>
                </div>
      </div>
          </div>
        </div>
        <script type="text/javascript" src="js/custom.js?1409842217472"></script>
      </body>
    </html>